<!DOCTYPE HTML>
<!--
	Editorial by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
	<head>
		<title>Arnab Rahman Chowdhury</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="../../assets/css/main.css" />
	</head>
	<body class="is-preload">

		<!-- Wrapper -->
			<div id="wrapper">

				<!-- Main -->
					<div id="main">
						<div class="inner">

							<!-- Header -->
								<header id="header">
									<ul class="icons">
										<li><a href="https://www.facebook.com/a.r.chowdhury.18/" class="icon brands fa-facebook-f"><span class="label">Facebook</span></a></li>
										<li><a href="https://www.instagram.com/chowdhury_arnab_rahman/" class="icon brands fa-instagram"><span class="label">Instagram</span></a></li>
										<li><a href="https://linkedin.com/in/archowdhury18" class="icon brands fa fa-linkedin"><span class="label">Linkedin</span></a></li>
										<li><a href="https://github.com/chowdhury18" class="icon brands fab fa-github-square"><span class="label">Github</span></a></li>
									</ul>
								</header>

							<!-- Banner -->
								<section>
									<header class="main">
										<h1>RESTful API using NodeJS and MongoDB</h1>
									</header>

									<span class="image main"><img src="../../images/nodejsREST.png" alt="" /></span>

									<hr class="major" />
									<h2>Objective</h2>
									<p>
										Create a <b>RESTful API using NodeJS and MongoDB</b>. <b>Node.js</b> is an open-source, cross-platform, JavaScript runtime environment that executes JavaScript code outside a web browser.
									</p>
									<hr class="major" />
									<h2>Getting started</h2>
									<h3>Prerequisites:</h3>
									<div class="table-wrapper">
										<table>
											<thead>
												<tr>
													<th>Library</th>
												</tr>
											</thead>
											<tbody>
												<tr>
													<td>NodeJS</td>
												</tr>
												<tr>
													<td>MongoDB</td>
												</tr>
											</tbody>
										</table>
									</div>
									<p>First, check out the environment setup to ensure everything works perfectly. Run <i><b>npm -v</b></i> and <i><b>mongo --version</b></i> to check the libraries are installed in your machine.</p>

									<h3>Description</h3>
									<p>This application implements CRUD (create-read-update-delete) operation by HTTP methods (GET, POST, PUT, DELETE). The CRUD operation performs on three schemas (Professor, ResearchGroup and Student). Moreover, the professors can be searched by designation and research group name. Similarly, the students can be searched by research group name. The schemas are given below:</p>
									<h4> Professor </h4>
									<div class="table-wrapper">
										<table>
											<thead>
												<tr>
													<th>Attribute</th>
													<th>Type</th>
													<th>Condition</th>
													<th>Values</th>
												</tr>
											</thead>
											<tbody>
												<tr>
													<td>name</td>
													<td>string</td>
													<td>required: true</td>
													<td>any valid string</td>
												</tr>
												<tr>
													<td>designation</td>
													<td>string</td>
													<td>required: true</td>
													<td>enum: ['Professor','Associate Professor','Assistant Professor']</td>
												</tr>
												<tr>
													<td>email</td>
													<td>string</td>
													<td>--</td>
													<td>any valid string</td>
												</tr>
												<tr>
													<td>interests</td>
													<td>list</td>
													<td>--</td>
													<td>[any valid string , ..]</td>
												</tr>
												<tr>
													<td>researchGroups</td>
													<td>list of ResearchGroup</td>
													<td>--</td>
													<td>[researchGroupID , ..]</td>
												</tr>
											</tbody>
										</table>
									</div>
									<h4> ResearchGroup </h4>
									<div class="table-wrapper">
										<table>
											<thead>
												<tr>
													<th>Attribute</th>
													<th>Type</th>
													<th>Condition</th>
													<th>Values</th>
												</tr>
											</thead>
											<tbody>
												<tr>
													<td>name</td>
													<td>string</td>
													<td>required: true</td>
													<td>any valid string</td>
												</tr>
												<tr>
													<td>founder</td>
													<td>Professor</td>
													<td>required: true</td>
													<td>prof_id</td>
												</tr>
												<tr>
													<td>description</td>
													<td>string</td>
													<td>--</td>
													<td>any valid string</td>
												</tr>
											</tbody>
										</table>
									</div>
									<h4> Student </h4>
									<div class="table-wrapper">
										<table>
											<thead>
												<tr>
													<th>Attribute</th>
													<th>Type</th>
													<th>Condition</th>
													<th>Values</th>
												</tr>
											</thead>
											<tbody>
												<tr>
													<td>name</td>
													<td>string</td>
													<td>required: true</td>
													<td>any valid string</td>
												</tr>
												<tr>
													<td>studentNumber</td>
													<td>string</td>
													<td>required: true</td>
													<td>any valid string</td>
												</tr>
												<tr>
													<td>researchGroups</td>
													<td>list of ResearchGroup</td>
													<td>--</td>
													<td>[researchGroupID , ..]</td>
												</tr>
											</tbody>
										</table>
									</div>
									<p>CRUD operations on the schemas are given below:</p>
									<h4> Professor </h4>
									<div class="table-wrapper">
										<table>
											<thead>
												<tr>
													<th>Request</th>
													<th>Type</th>
													<th>Route</th>
													<th>Request Body</th>
													<th>Response Body</th>
													<th>Status code</th>
												</tr>
											</thead>
											<tbody>
												<tr>
													<td>CREATE</td>
													<td>POST</td>
													<td>/listProfessor</td>
													<td>Professor</td>
													<td>{ message: 'Professor successfully created', id: <b>prof_id</b> }</td>
													<td>201</td>
												</tr>
												<tr>
													<td>READ</td>
													<td>GET</td>
													<td>/listProfessor/{prof_id}</td>
													<td>--</td>
													<td>Single database object { name: <b>name</b>, email: <b>email</b>, designation: <b>designation</b>, interests: <b>[interest , ..]</b> }</td>
													<td>200</td>
												</tr>
												<tr>
													<td>READ</td>
													<td>GET</td>
													<td>/listProfessors</td>
													<td>designation OR groupName (*)</td>
													<td>Multiple database objects { name: <b>name</b>, email: <b>email</b> }</td>
													<td>200</td>
												</tr>
												<tr>
													<td>UPDATE</td>
													<td>PUT</td>
													<td>/listProfessor/{prof_id}</td>
													<td>Professor</td>
													<td>{ message: 'Professor successfully updated', id: <b>prof_id</b> }</td>
													<td>200</td>
												</tr>
												<tr>
													<td>DELETE</td>
													<td>DELETE</td>
													<td>/listProfessor/{prof_id}</td>
													<td>--</td>
													<td>{ message: 'Professor successfully deleted', id: <b>prof_id</b> }</td>
													<td>200</td>
												</tr>
											</tbody>
										</table>
									</div>
									<p><b>NOTE:</b> (*) For GET requests, use the query string to pass the parameters.</p>
									<h4> ResearchGroup </h4>
									<div class="table-wrapper">
										<table>
											<thead>
												<tr>
													<th>Request</th>
													<th>Type</th>
													<th>Route</th>
													<th>Request Body</th>
													<th>Response Body</th>
													<th>Status code</th>
												</tr>
											</thead>
											<tbody>
												<tr>
													<td>CREATE</td>
													<td>POST</td>
													<td>/listGroup</td>
													<td>ResearchGroup</td>
													<td>{ message: 'Group successfully created', id: <b>group_id</b> }</td>
													<td>201</td>
												</tr>
												<tr>
													<td>READ</td>
													<td>GET</td>
													<td>/listGroup/{group_id}</td>
													<td>--</td>
													<td>Single database object { id: <b>group_id</b>, name: <b>name</b>, founder: <b>prof_id</b> }</td>
													<td>200</td>
												</tr>
												<tr>
													<td>UPDATE</td>
													<td>PUT</td>
													<td>/listGroup/{group_id}</td>
													<td>ResearchGroup</td>
													<td>{ message: 'Group successfully updated', id: <b>group_id</b> }</td>
													<td>200</td>
												</tr>
												<tr>
													<td>DELETE</td>
													<td>DELETE</td>
													<td>/listGroup/{group_id}</td>
													<td>--</td>
													<td>{ message: 'Group successfully deleted', id: <b>group_id</b> }</td>
													<td>200</td>
												</tr>
											</tbody>
										</table>
									</div>
									<h4> Student </h4>
									<div class="table-wrapper">
										<table>
											<thead>
												<tr>
													<th>Request</th>
													<th>Type</th>
													<th>Route</th>
													<th>Request Body</th>
													<th>Response Body</th>
													<th>Status code</th>
												</tr>
											</thead>
											<tbody>
												<tr>
													<td>CREATE</td>
													<td>POST</td>
													<td>/listStudent</td>
													<td>Student</td>
													<td>{ message: 'Student successfully created', id: <b>student_id</b> }</td>
													<td>201</td>
												</tr>
												<tr>
													<td>READ</td>
													<td>GET</td>
													<td>/listStudent/{student_id}</td>
													<td>--</td>
													<td>Single database object { name: <b>name</b>, studentNumber: <b>studentNumber</b>, researchGroups: [<b>group_id , ..</b>] }</td>
													<td>200</td>
												</tr>
												<tr>
													<td>READ</td>
													<td>GET</td>
													<td>/listStudents</td>
													<td>groupName (*)</td>
													<td>Multiple database objects { name: <b>name</b>, studentNumber: <b>studentNumber</b> }</td>
													<td>200</td>
												</tr>
												<tr>
													<td>UPDATE</td>
													<td>PUT</td>
													<td>/listStudent/{student_id}</td>
													<td>Student</td>
													<td>{ message: 'Student successfully updated', id: <b>student_id</b> }</td>
													<td>200</td>
												</tr>
												<tr>
													<td>DELETE</td>
													<td>DELETE</td>
													<td>/listStudent/{student_id}</td>
													<td>--</td>
													<td>{ message: 'Student successfully deleted', id: <b>student_id</b> }</td>
													<td>200</td>
												</tr>
											</tbody>
										</table>
									</div>
									<p><b>NOTE:</b> (*) For GET requests, use the query string to pass the parameters.</p>
									<h3>File structure</h3>
									<pre><code>
nodejsREST
|- server.js
|__api
   |__controllers
	|- professorController.js
	|- researchGroupController.js
	|- studentController.js
   |__models
	|- professor.js
	|- researchGroup.js
	|- student.js
   |__routes
	|- professorRoutes.js
	|- researchGroupRoutes.js
	|- studentRoutes.js
</code></pre>
									<h3>Step by step procedure</h3>
									<ul class="alt">
										<ol>
											<li>Create a folder (e.g., nodejsREST)</li>
											<li>Create package.json <br>
												- Run <b>npm init</b> <br>
												Package.json is a file that gives the necessary information to npm which allows it to identify the project as well as handle the project's dependencies. Fill out some information regarding the application.
											</li>
											<li>Create a server (e.g., server.js)<br>
												- Run <b>npm install express --save</b> to create the node server.<br>
												- Run <b>npm install -save-dev nodemon</b> to track the changes and run the server automatically.
											</li>
											<li>Change starting point to <b>nodemon server.js</b>.</li>
											<li>Setting up the schema <br>
												- Run <b>npm install mongoose --save</b> to interact with a MongoDB (Database) instance.
											</li>
										</ol>
									</ul>
									<h3>Models definition</h3>
									<p><i>nodejsREST/models/professor.js</i>: </p>
									<pre><code>
'use strict';
var mongoose = require('mongoose');
var schema = mongoose.Schema;

var professorSchema = new schema ({
    name: {
        type: String,
        required: true
    },
    designation: {
        type: String,
        enum: ['Professor','Associate Professor','Assistant Professor'],
        default: 'Professor',
        required: true
    },
    email: {
        type: String
    },
    interests: [{
        type: String
    }],
    researchGroups: [{
        type: schema.Types.ObjectId,
        ref: 'ResearchGroup'
    }]   
});

module.exports = mongoose.model('Professor', professorSchema);
</code></pre>
									<p><i>nodejsREST/models/researchGroup.js</i>: </p>
									<pre><code>
'use strict';
var mongoose = require('mongoose');
var schema = mongoose.Schema;

var researchGroupSchema = new schema ({
    name: {
        type: String,
        required: true,
        unique: true,
        dropDups: true
    },
    description: {
        type: String
    },
    founder: {
        type: schema.Types.ObjectId,
        ref: 'Professor'
    }
});

module.exports = mongoose.model('ResearchGroup', researchGroupSchema);
</code></pre>
									<p><i>nodejsREST/models/student.js</i>: </p>
									<pre><code>
'use strict';
var mongoose = require('mongoose');
var schema = mongoose.Schema;

var studentSchema = new schema({
    name: {
        type: String,
        required: true
    },
    studentNumber: {
        type: String,
        required: true
    },
    researchGroups: [{
        type: schema.Types.ObjectId,
        ref: 'ResearchGroup'
    }]
});

module.exports = mongoose.model('Student',studentSchema);
</code></pre>
									<h3>Routes definition</h3>
									<p><i>nodejsREST/routes/professorRoutes.js</i>: </p>
									<pre><code>
'use strict';
var professorQuery = function(app) {
    var professorController = require('../controllers/professorController');
    
    app.route('/listProfessors')
        .get(professorController.list_all_professors)

    app.route('/listProfessor')
        .post(professorController.add_professor);

    app.route('/listProfessor/:professorID')
        .get(professorController.read_a_professor)
        .put(professorController.update_a_professor)
        .delete(professorController.delete_a_professor);
};

module.exports = professorQuery;
</code></pre>
									<p><i>nodejsREST/routes/researchGroupRoutes.js</i>: </p>
									<pre><code>
'use strict';
var groupQuery = function(app) {
    var groupController = require('../controllers/researchGroupController');
    
    app.route('/listGroups')
        .get(groupController.list_all_groups)

    app.route('/listGroup')
        .post(groupController.add_group);

    app.route('/listGroup/:groupID')
        .get(groupController.read_a_group)
        .put(groupController.update_a_group)
        .delete(groupController.delete_a_group);
};

module.exports = groupQuery;
</code></pre>
									<p><i>nodejsREST/routes/studentRoutes.js</i>: </p>
									<pre><code>
'use strict';
var studentQuery = function(app) {
    var studentController = require('../controllers/studentController');
    
    app.route('/listStudents')
        .get(studentController.list_all_students)

    app.route('/listStudent')
        .post(studentController.add_student);

    app.route('/listStudent/:studentID')
        .get(studentController.read_a_student)
        .put(studentController.update_a_student)
        .delete(studentController.delete_a_student);
};

module.exports = studentQuery;
</code></pre>
									<h3>Controllers definition</h3>
									<p><i>nodejsREST/controllers/professorController.js</i>: </p>
									<pre><code>
'use strict'

var mongoose = require('mongoose');
mongoose.set('useFindAndModify', false);
var professorModel = mongoose.model('Professor');
var researchGroupModel = mongoose.model('ResearchGroup');

exports.list_all_professors = function (req, res){
    const keys = Object.keys(req.query);
    const values = Object.values(req.query);
    var designations = ['Professor','Associate Professor','Assistant Professor'];
    var profs = [];
    if (keys[0] == 'designation') {
        if (designations.includes(values[0])){
            professorModel.find({designation: values[0]}, function(err, professors){
                if (err) {
                    res.status(404).json({message: 'Invalid professor\'s designation'});
                }
                for (var prof in professors) {
                    profs.push({name: professors[prof]['name'],email: professors[prof]['email']});
                }
                res.status(200).json(profs);
            });
        } else {
            res.status(200).json({message: 'No professors with such designation.'});
        }
    }
    else if (keys[0] == 'groupName'){
        researchGroupModel.find({name: values[0]}, function (err, groups){
            if (err) {
                res.status(404).json({message: 'Invalid group\'s name'});
            }
            if (Object.keys(groups).length != 0){
                var group_id = groups[0]['_id']
                professorModel.find({researchGroups: group_id}, function (err, professors){
                    if (err) {
                        res.status(404).json({message: 'Invalid group\'s ID'});
                    }
                    for (var prof in professors) {
                        profs.push({name: professors[prof]['name'],email: professors[prof]['email'],
						designation: professors[prof]['designation']});
                    }
                    res.status(200).json(profs);
                });
            }else {
                res.status(200).json({message: 'No groups with such name.'}); 
            }
            
        });
    }
    else {
        professorModel.find({}, function(err, professors) {
            if (err) {
                res.status(404).send(err);
            }
            for (var prof in professors) {
                profs.push({name: professors[prof]['name'],email: professors[prof]['email'],
				designation: professors[prof]['designation']});
            }
            res.status(200).json(profs);
        });
    }
};

exports.add_professor = function (req, res){
    var new_prof = new professorModel(req.body);
    new_prof.save(
        function(err, professor) {
            if (err) {
                res.status(404).send(err);
            }
            else {
                res.status(201).json({message: 'Professor successfully created', id: professor['_id']});
            }
        });
};

exports.read_a_professor = function (req, res){
    professorModel.findById(req.params.professorID, function (err, professor){
        if (err) {
            res.status(404).json({message: 'Invalid professor\'s ID'});
        }
        res.status(200).json({name: professor['name'],email: professor['email'],designation: professor['designation'],
		interests: professor['interests']});
    });
};


exports.update_a_professor = function (req, res) {
    professorModel.findOneAndUpdate({_id: req.params.professorID}, req.body, {new: true}, function (err, professor){
        if (err) {
            res.status(404).json({message: 'Invalid professor\'s ID'});
        }
        res.status(200).json({message: 'Professor successfully updated',id: professor['_id']});
    });
};

exports.delete_a_professor = function (req, res) {
    professorModel.findOneAndRemove({_id: req.params.professorID}, function (err, professor){
        if (err){
            res.status(404).json({message: 'Invalid professor\'s ID'});
        }
        researchGroupModel.remove({founder: req.params.professorID}).exec();
        res.status(200).json({message: 'Professor successfully deleted',id: req.params.professorID});
    });
};
</code></pre>
									<p><i>nodejsREST/controllers/researchGroupController.js</i>: </p>
									<pre><code>
'use strict'

var mongoose = require('mongoose');
mongoose.set('useFindAndModify', false);
var professorModel = mongoose.model('Professor');
var researchGroupModel = mongoose.model('ResearchGroup');
var studentModel = mongoose.model('Student');

exports.list_all_groups = function (req, res){
    var grps = [];
    researchGroupModel.find({}, function(err, groups) {
        if (err) {
            res.status(404).send(err);
        }
        for (var grp in groups) {
            grps.push({name: groups[grp]['name'],founder: groups[grp]['founder']});
        }
        res.status(200).json(grps);
    });
};

exports.add_group = function (req, res){
    var new_group = new researchGroupModel({_id: new mongoose.Types.ObjectId(), name: req.body.name, description: req.body.description});
    var founderID = req.body.founder;
    professorModel.findOneAndUpdate(
        {_id: founderID},
        {$addToSet: {researchGroups: new_group._id}},
        function (err, professor){
            if (err) {
                res.status(404).json({message: 'Invalid professor\'s ID'});
            }
            else {
                new_group.founder = founderID;
                new_group.save(function( err, group){
                    if (err){
                        res.status(404).send(err);
                    }
                    res.status(201).json({message: 'Group successfully created',id: group['_id']});
                });
            }
        });
};

exports.read_a_group = function (req, res){
    researchGroupModel.findById(req.params.groupID, function (err, group){
        if (err) {
            res.status(404).json({message: 'Invalid group\'s ID'});
        }
        res.status(200).json({id: group._id,name: group.name,founder: group.founder});
    });
};

exports.update_a_group = function (req, res) {
    researchGroupModel.findOneAndUpdate({_id: req.params.groupID}, req.body, {new: true}, function (err, group){
        if (err) {
            res.status(404).json({message: 'Invalid group\'s ID'});
        }
        res.status(200).json({message: 'Group successfully updated',id: group['_id']});
    });
};

exports.delete_a_group = function (req, res) {
    researchGroupModel.findOneAndRemove({_id: req.params.groupID}, function (err, group){
        if (err){
            res.status(404).json({message: 'Invalid group\'s ID'});
        }
        var groupid = req.params.groupID;
        professorModel.updateMany(
            {researchGroups: groupid},
            {$pull: {researchGroups: groupid}}
        ).exec();
        studentModel.updateMany(
            {researchGroups: groupid},
            {$pull: {researchGroups: groupid}}
        ).exec();
        /*
        professorModel.find({researchGroups: groupid}, function (err, professors){
            if (err) {
                res.status(404).json({message: 'Invalid group\'s ID'});
            }
            if (professors){
                for (var prof in professors) {
                    professorModel.findOneAndUpdate(
                        {_id: professors[prof]['_id']},
                        {$pull: {'researchGroups': groupid}}
                    );
                }
            } else{
                res.status(404).json({message: 'No professors are in the group.'});
            }           
        });*/
        res.status(200).json({message: 'Group successfully deleted',id: req.params.groupID});
    });
};
</code></pre>
									<p><i>nodejsREST/controllers/studentController.js</i>: </p>
									<pre><code>
'use strict'

var mongoose = require('mongoose');
mongoose.set('useFindAndModify', false);
var professorModel = mongoose.model('Professor');
var researchGroupModel = mongoose.model('ResearchGroup');
var studentModel = mongoose.model('Student');

exports.list_all_students = function (req, res){
    const keys = Object.keys(req.query);
    const values = Object.values(req.query);
    var stds = [];
    if (keys[0] == 'groupName'){
        researchGroupModel.find({name: values[0]}, function (err, groups){
            if (err) {
                res.status(404).json({message: 'Invalid group\'s name'});
            }
            if (Object.keys(groups).length != 0){
                var group_id = groups[0]['_id']
                studentModel.find({researchGroups: group_id}, function(err, students){
                    if (err) {
                        res.status(404).json({message: 'Invalid group\'s ID'});
                    }
                    for (var std in students) {
                        stds.push({name: students[std]['name'],studentNumber: students[std]['studentNumber']});
                    }
                    res.status(200).json(stds);
                });
            }else {
                res.status(200).json({message: 'No groups with such name.'}); 
            }
            
        });
    } else {
        studentModel.find({}, function(err, students) {
            if (err) {
                res.send(err);
            }
            if (students) {
                for (var std in students) {
                    stds.push({name: students[std]['name'],studentNumber: students[std]['studentNumber']});
                }
                if (stds.length == 0){
                    res.status(200).json({message: "No student enrolled"});
                }
                res.status(200).json(stds);
            }
        });
    }
};

exports.add_student = function (req, res){
    var new_student = new studentModel(req.body);
    new_student.save(
        function(err, student) {
            if (err) {
                res.status(404).send(err);
            }
            res.status(201).json({message: 'Student successfully created', id: student['_id']});
        });
};

exports.read_a_student = function (req, res){
    studentModel.findById(req.params.studentID, function (err, student){
        if (err) {
            res.status(404).json({message: 'Invalid student\'s ID'});
        }
        res.status(200).json({name: student['name'],studentNumber: student['studentNumber'],researchGroups: student['researchGroups']});
    });
};

exports.update_a_student = function (req, res) {
    studentModel.findOneAndUpdate({_id: req.params.studentID}, req.body, {new: true}, function (err, student){
        if (err) {
            res.status(404).json({message: 'Invalid student\'s ID'});
        }
        res.status(200).json({message: 'Student successfully updated',id: student['_id']});
    });
};

exports.delete_a_student = function (req, res) {
    studentModel.findOneAndRemove({_id: req.params.studentID}, function (err, student){
        if (err){
            res.status(404).json({message: 'Invalid student\'s ID'});
        }
        res.status(200).json({message: 'Student successfully deleted',id: req.params.studentID});
    });
};
</code></pre>
									<h3>Server definition</h3>
									<p><i>nodejsREST/server.js</i>: </p>
									<pre><code>
var express = require('express');
var app = express();
var port = process.env.PORT || 3000;
var mongoose = require('mongoose');
var professorModel = require('./api/models/professor');
var groupModel = require('./api/models/researchGroup'); 
var studentModel = require('./api/models/student');
var bodyParser = require('body-parser');

var connURL = "mongodb://localhost/db";
const options = {
    useNewUrlParser: true, 
    useUnifiedTopology: true, 
    useCreateIndex: true
};

const connectWithRetry = () => {
    console.log('MongoDB connection with retry')
    mongoose.connect(connURL, options).then(()=>{
      console.log('MongoDB is connected')
    }).catch(err=>{
      console.log('MongoDB connection unsuccessful, retry after 5 seconds.');
      setTimeout(connectWithRetry, 3000);
    });
}

connectWithRetry();
var db = mongoose.connection;
db.on('error', console.error.bind(console, 'MongoDB connection error:'));
mongoose.Promise = global.Promise;
//mongoose.connect('mongodb://mongo:27017/db',{useNewUrlParser: true, useUnifiedTopology: true, 'useCreateIndex': true});

app.use(bodyParser.urlencoded({extended: true}));
app.use(bodyParser.json());

var professorRoutes = require('./api/routes/professorRoutes');
var groupRoutes = require('./api/routes/researchGroupRoutes');
var studentRoutes = require('./api/routes/studentRoutes');
professorRoutes(app);
groupRoutes(app);
studentRoutes(app);

app.listen(port);

console.log('APP started... on port: ' + port);
</code></pre>
									<p><b>NOTE:</b> In database config section, <i>db</i> represents the name of the database.</p>
									<h3>To start and run the without reloading</h3>
									<p>Check the mongo daemon is running background. To start the daemon, run <b>mongod</b>. To interact with the mongo shell, run <b>mongo shell</b>. Start the server running <b>npm start</b>.</p>
									<pre><code>
npm start

Terminal output:
[nodemon] 2.0.4
[nodemon] to restart at any time, enter rs
[nodemon] watching path(s): *.*
[nodemon] watching extensions: js,mjs,json
[nodemon] starting node server.js
MongoDB connection with retry
APP started... on port: 3000
</code></pre>
									<p> The server is running on <i>http://localhost:3000</i>. Download (<a href="https://www.postman.com/">postman</a>) OR use command line tool (<a href="https://curl.haxx.se/">curl</a>) to execute the operations. The following <a href="https://www.taniarascia.com/making-api-requests-postman-curl/">link</a> has the instructions to execute CRUD in both postman and curl.</p>
									<p><b>Download code: </b> <a href="https://github.com/chowdhury18/nodejsREST"> Github </a></p> 
								</section>

						</div>
					</div>

				<!-- Sidebar -->
					<div id="sidebar">
						<div class="inner">
							<!-- Menu -->
								<nav id="menu">
									<header class="major">
										<h2>Menu</h2>
									</header>
									<ul>
										<li><a href="../../index.html">Homepage</a></li>
								</nav>


							<!-- Section -->
								<section>
									<header class="major">
										<h2>Get in touch</h2>
									</header>
									<ul class="contact">
										<li class="icon solid fa-envelope"><a href="mailto: arnab.chowdhury@aalto.fi">arnab.chowdhury@aalto.fi</a></li>
										<li class="icon solid fa-phone">(+358) 442428984</li>
										<li class="icon solid fa-home">Jamerantaival 11 L 235<br />
										02150, ESPOO, Finland</li>
									</ul>
								</section>

							<!-- Footer -->
								<footer id="footer">
									<p class="copyright">&copy; 2020 Arnab Rahman Chowdhury</p>
								</footer>

						</div>
					</div>


		<!-- Scripts -->
			<script src="../assets/js/jquery.min.js"></script>
			<script src="../assets/js/browser.min.js"></script>
			<script src="../assets/js/breakpoints.min.js"></script>
			<script src="../assets/js/util.js"></script>
			<script src="../assets/js/main.js"></script>
			<!--<script src="assets/js/jquery.includeHTML.min.js"></script>
			https://github.com/louisho5/jQuery-Include-HTML-File-Plugin 
			<script>
				$(document).ready(function () {
					$("#sidebar-temp").load("sidebar.html");
					$("#header-temp").load("header.html");
				});
			</script>-->
	</body>
</html>